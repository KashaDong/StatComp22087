<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yixi Dong" />

<meta name="date" content="2022-12-08" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Yixi Dong</h4>
<h4 class="date">2022-12-08</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This document contains all the meaningful functions from homework
answers of statistical computation class of autumn, 2022. The document
is organized in chronological order from 2022/9/15 to 2022/11/18.</p>
</div>
<div id="section" class="section level2">
<h2>2022/9/15</h2>
<p>Exercises 3.3, 3.7, 3.12, and 3.13. (pages 94-96, Statistical
Computing with R).</p>
<div id="generate-parato22-samples-by-inverse-transformation-method" class="section level3">
<h3>3.3: Generate <span class="math inline">\(Parato(2,2)\)</span>
samples by inverse transformation method</h3>
<p>Function <code>ParatoGen</code> implements inverse transformation
method to generate <span class="math inline">\(Parato(2,2)\)</span>
samples of size <code>n</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ParatoGen <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  f_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">f_inv</span>(<span class="fu">runif</span>(n))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can check the result by graph the histogram of generated samples
and the true density of <span class="math inline">\(Parato(2,2)\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22087)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ParatoGen</span>(<span class="fl">1e4</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">breaks=</span><span class="dv">300</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">8</span><span class="sc">*</span>x<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.5</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="generate-betaab-samples-by-ar-method" class="section level3">
<h3>3.7: Generate <span class="math inline">\(Beta(a,b)\)</span> samples
by AR method</h3>
<p>Function <code>BetaGen</code> implements Acceptance-Rejection method
to generate <span class="math inline">\(Beta(a,b)\)</span> samples of
size <code>n</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>BetaGen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">1</span>){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> x0<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x0)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u <span class="sc">&lt;=</span> x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span>c){</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      s[i] <span class="ot">&lt;-</span> x</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span>n) <span class="cf">break</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can check the result by graph the histogram of generated samples
and the true density of <span class="math inline">\(Beta(3,2)\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">BetaGen</span>(<span class="dv">1000</span>, <span class="at">a=</span><span class="dv">3</span>, <span class="at">b=</span><span class="dv">2</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="dv">15</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">integrate</span>(B0, <span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">$</span>value</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">B0</span>(x)<span class="sc">/</span>z</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>), <span class="fu">B</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="generate-exponential-gamma-mixture-samples" class="section level3">
<h3>3.12&amp;3.13: Generate Exponential-Gamma mixture samples</h3>
<p>Function <code>MixGen</code> simulates a continuous Exponential-Gamma
mixture, where <span class="math display">\[\Lambda \sim Gamma(\gamma,
\beta),\quad Y \sim Exp(\Lambda).\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MixGen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">gamma=</span><span class="dv">4</span>, <span class="at">beta=</span><span class="dv">2</span>){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, gamma, beta)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can check the result by graph the histogram of generated samples
of <span class="math inline">\(\gamma=4, \beta=2\)</span> and the true
density.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gamma<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">MixGen</span>(<span class="fl">1e4</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,  <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">breaks=</span><span class="dv">30</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="fl">0.1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) gamma<span class="sc">*</span>beta<span class="sc">^</span>gamma<span class="sc">*</span>(beta<span class="sc">+</span>x)<span class="sc">^</span>(<span class="sc">-</span>gamma<span class="dv">-1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-1" class="section level2">
<h2>2022/9/23</h2>
<p>Class work and Exercise 5.6, 5.7. (page 149-151, Statistical
Computing with R)</p>
<div id="class-work-apply-the-fast-sorting-algorithm" class="section level3">
<h3>Class work: apply the fast sorting algorithm</h3>
<p>The <code>quick_sort</code> function apply the fast sorting
algorithm, we supposed to:</p>
<ul>
<li>For <span class="math inline">\(n=10^4,\ 2\times 10^4,\ 4\times
10^4,\ 6\times 10^4,\ 8\times 10^4,\)</span> apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results. (scatter plot and regression line)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And then we can complete the class following the tips:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Caltime <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">num_repeat=</span><span class="dv">100</span>){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_repeat)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_repeat){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(s))[<span class="dv">1</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(t))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply Caltime to n</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(n, Caltime))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># regression and plot</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(t,a))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">lm</span>(a<span class="sc">~</span>t, d)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d, <span class="at">main =</span> <span class="st">&quot;Regress &#39;a&#39; on &#39;t&#39;&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(r)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="theoretical-variance-reduction-of-antithetic-variate-approach" class="section level3">
<h3>5.6: Theoretical variance reduction of antithetic variate
approach</h3>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta=\int_0^1 e^x
\mathrm{d}x.\]</span> Now consider the antithetic variate approach.
Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim U(0,1)\)</span>. What is the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p>By simple calculation we have <span class="math display">\[Cov(e^U,e^{1-U})=\mathrm{E}[e^Ue^{1-U}]-\mathrm{E}e^U\mathrm{E}e^{1-U}=e-(e-1)^2,\]</span>
<span class="math display">\[Var(e^U+e^{1-U})=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})=(e^2-1)-4(e-1)^2+2e.\]</span>
Thus we could estimate <span class="math inline">\(\hat{\theta}\)</span>
by the mean value of <span class="math inline">\((1/2)(e^U+e^{1-U})\)</span>, compared with simple
MC estimator mean of <span class="math inline">\((e^U+e^V)/2,\ V\sim
U(0,1\)</span> and <span class="math inline">\(V\)</span> is independent
of <span class="math inline">\(U\)</span>, we have <span class="math display">\[var((1/2)(e^U+e^{1-U}))=(1/4)((e^2-1)-4(e-1)^2+2e)=0.00391,\]</span>
<span class="math display">\[var((1/2)(e^U+e^{V}))=(1/4)2var(e^U)=0.12102.\]</span>
Then the reduction of variance would be <span class="math inline">\(0.96769\)</span>.</p>
</div>
<div id="simulation-compare-simple-monte-carlo-and-antithetic-variate-approach" class="section level3">
<h3>5.7: Simulation: Compare simple Monte Carlo and antithetic variate
approach</h3>
<p>Function <code>MonteGen</code> can calculate integration of <span class="math inline">\(e^x\)</span> on <span class="math inline">\([0,1]\)</span> with or without antithetic variate
approach.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>MonteGen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">antithetic=</span><span class="cn">TRUE</span>){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u,v)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Below we use <code>MonteGen</code> to simulate the variance
reduction.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sMC <span class="ot">&lt;-</span> aMC <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  sMC[i] <span class="ot">&lt;-</span> <span class="fu">MonteGen</span>(n, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  aMC[i] <span class="ot">&lt;-</span> <span class="fu">MonteGen</span>(n)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(sMC)<span class="sc">-</span><span class="fu">var</span>(aMC))<span class="sc">/</span><span class="fu">var</span>(sMC)</span></code></pre></div>
<pre><code>## [1] 0.9683011</code></pre>
</div>
</div>
<div id="section-2" class="section level2">
<h2>2022/9/30</h2>
<p>Exercises 5.13, 5.15.(pages 149-151, Statistical Computing with
R).</p>
<div id="importance-sampling-method" class="section level3">
<h3>5.13: Importance sampling method</h3>
<p><strong>Q</strong>: Find two important functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)= \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^{\infty}
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\mathrm{d}x,\quad x&gt;1.\]</span></p>
<p><strong>A</strong>: We can consider</p>
<ul>
<li><span class="math inline">\(f_1(x)=\frac{\sqrt{2}}{\sqrt{\pi}}e^{-(x-1)^2/2},\quad
1&lt;x&lt;\infty\)</span></li>
<li><span class="math inline">\(f_2(x)=\frac{(1.8)^2}{\Gamma(2)}(x-1)e^{-1.8(x-1)^2},\quad
1&lt;x&lt;\infty\)</span></li>
</ul>
<p>For <span class="math inline">\(f_1\)</span>, we can generate the
samples by sampling from the <span class="math inline">\(N(1,1)\)</span>
normal distribution and keep the value bigger than 1. For <span class="math inline">\(f_2\)</span>, we can generate samples from <span class="math inline">\(\Gamma(2,1.8)\)</span> and keep the value plus 1.
In order to compare the two importance sampling methods, we compare
<span class="math inline">\(g/f_1\)</span> and <span class="math inline">\(g/f_2\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fl">3.14159</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>)), <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">main =</span> <span class="st">&quot;comparing the ratio&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;ratios of g and the candidate functions&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="dv">2</span>, <span class="fl">1.8</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Normal distribution would be a better choice as the ratio of <span class="math inline">\(g/f_1\)</span> is closer to a constant.</p>
</div>
<div id="stratified-importance-sampling" class="section level3">
<h3>5.15: Stratified importance sampling</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10. In Example 5.10 our best
result was obtained with importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span>. Now
divide the interval to five sub-intervals, such that each interval has
probability <span class="math inline">\(1/5\)</span> under the density
function <span class="math inline">\(f\)</span>.</p>
<p>Function <code>StrImpSam</code> implements the stratified importance
sampling method in the case mentioned above.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>StrImpSam <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">m=</span><span class="dv">100</span>){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  thetai <span class="ot">&lt;-</span> <span class="cf">function</span>(i, n){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> i<span class="sc">/</span><span class="dv">5</span><span class="sc">+</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>))<span class="sc">*</span>u)) <span class="co">#inverse distribution</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    thetaihat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="sc">-</span>i<span class="sc">/</span><span class="dv">5</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(thetaihat)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) theta[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">vapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,thetai,<span class="dv">1</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We will compare the variance between stratified importance sampling
method and the naive importance sampling method.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Stratified:&quot;</span>, <span class="fu">var</span>(<span class="fu">StrImpSam</span>(<span class="at">n=</span><span class="dv">100</span>)))</span></code></pre></div>
<pre><code>## Stratified: 4.549336e-07</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Naive:&quot;</span>,<span class="fu">var</span>(<span class="fu">ImpSam</span>(<span class="at">n=</span><span class="dv">500</span>)))</span></code></pre></div>
<pre><code>## 
## Naive: 1.763499e-05</code></pre>
</div>
</div>
<div id="section-3" class="section level2">
<h2>2022/10/9</h2>
<p>Exercises 6.4, 6.8(pages 180-181, Statistical Computing with R).</p>
<div id="monte-carlo-method-to-obtain-empirical-confidence-interval" class="section level3">
<h3>6.4: Monte Carlo method to obtain empirical confidence interval</h3>
<p>Suppose that <span class="math inline">\(X_1, \cdots, X_n\)</span>
are a random sample from a from a <span class="math inline">\(\log
normal\)</span> distribution with unknown parameters. Construct a 95%
confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p>For this, we write a function <code>CI_lognormal</code> to simulate
the 95% confidence interval using Monte Carlo, and then do a simple
simulation to check if it is a a 95% confidence interval.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>CI_lognormal <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  yse <span class="ot">&lt;-</span> <span class="fu">sd</span>(y)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  lc <span class="ot">&lt;-</span> yhat <span class="sc">+</span> yse<span class="sc">/</span><span class="fu">sqrt</span>(m)<span class="sc">*</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df=</span>m<span class="dv">-1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(m)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  lc <span class="ot">&lt;-</span> <span class="fu">CI_lognormal</span>(x)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lc[<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">&amp;</span>lc[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>) count <span class="ot">&lt;-</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>count<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.946</code></pre>
</div>
<div id="compare-the-power-of-the-count-five-test-and-f-test" class="section level3">
<h3>6.5: Compare the power of the Count Five test and F test</h3>
<p>We give the two kinds of test <code>count5test</code> and
<code>Ftest</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>Ftest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value<span class="sc">&lt;=</span><span class="fl">0.055</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Below we use above the functions to do some comparisons:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  c5t <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x,y)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">Ftest</span>(x,y)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(c5t, ft)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  power <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">numeric</span>(<span class="dv">2000</span>), <span class="at">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span>k</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span>sd1)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span>sd2)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    power[i,] <span class="ot">&lt;-</span> <span class="fu">tests</span>(x,y)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span>k, <span class="fu">colMeans</span>(power), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 20 0.31 0.402 
## 200 0.939 1 
## 2000 0.998 1</code></pre>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p><strong>Q</strong>:</p>
<ul>
<li>If we obtain the powers for two methods under a particular
simulation setting with <span class="math inline">\(10,000\)</span>
experiments: say, <span class="math inline">\(0.651\)</span> for one
method and <span class="math inline">\(0.676\)</span> for another
method. Can we say the powers are different at <span class="math inline">\(0.05\)</span> level?</li>
<li>What is the corresponding hypothesis test problem?</li>
<li>Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</li>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
<p><strong>A</strong>:</p>
<ul>
<li>We need to test <span class="math display">\[H_0:\ p_1=p_2\quad
H_1:\ p_1\neq p_2,\]</span> here <span class="math inline">\(p_i\)</span> means the power of the <span class="math inline">\(i\)</span>th method.</li>
<li>The above test is equal to test two samples of <span class="math inline">\(B(1,p_1)\)</span> and <span class="math inline">\(B(1,p_2)\)</span>, which we can choose McNemar
method to test. Indeed, if the two samples are independent and n is
large enough, all the tests work, but as <span class="math inline">\(p_1\)</span>, <span class="math inline">\(p_2\)</span> are testing statistics from a same
hypothesis test problem using the same data, <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are not independent, which leads to
dependency of the two samples, so the previous tests do not work, we
should use McNemar instead as it is designed for the dependent-sample
test.</li>
<li>We need to know the exact numbers of samples that are rejected and
accepted by the <span class="math inline">\(i\)</span>th method, <span class="math inline">\(i=1,2\)</span>.</li>
</ul>
</div>
</div>
<div id="section-4" class="section level2">
<h2>2022/10/14</h2>
<p>Exercises 7.4, 7.5, 7.A(pages 212-213, Statistical Computing with
R).</p>
<div id="bootstrap-estimate-the-bias-and-standard-error" class="section level3">
<h3>7.4: Bootstrap: estimate the bias and standard error</h3>
<p>Refer to the air-conditioning data set <code>aircondit</code>
provided in the boot package. The 12 observations are the times in hours
between failures of <code>airconditioning</code> equipment: <span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98,100, 130, 230,
487.\]</span> Assume that the times between failures follow an
exponential model Exp(λ). Obtain the MLE of the hazard rate λ and use
bootstrap to estimate the bias and standard error of the estimate.</p>
<p>The log likelihood of <span class="math inline">\(n\)</span>
independent samples of Exp(<span class="math inline">\(\lambda\)</span>)
is <span class="math display">\[l(\lambda|X_1,\cdots,X_n)=n\log\lambda-\lambda\sum_{i=1}^nX_i,\]</span>
Thus the MLE is <span class="math inline">\(n/\sum_{i=1}^nX_i,\)</span>
which in this case is:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The MLE of lambda is&quot;</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(t))</span></code></pre></div>
<pre><code>## The MLE of lambda is 0.00925212</code></pre>
<p>Next we will use bootstrap to estimate the bias and standard error of
the estimate:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mB <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(t, <span class="at">replace =</span> T)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  mB[i] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The bias of the estimate is&quot;</span>, <span class="fu">mean</span>(mB)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(t))</span></code></pre></div>
<pre><code>## The bias of the estimate is 0.001340424</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The standard error of the estimate is&quot;</span>, <span class="fu">sd</span>(mB))</span></code></pre></div>
<pre><code>## The standard error of the estimate is 0.004309788</code></pre>
</div>
<div id="comparison-among-standard-normal-basic-percentile-and-bca-methods" class="section level3">
<h3>7.5: Comparison among standard normal, basic, percentile, and BCa
methods</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and <code>BCa</code> methods. Compare the intervals and
explain why they may differ.</p>
<p>We use <code>boot</code> package to compute the four kinds of
intervals:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mymean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>t, <span class="at">statistic=</span>mymean, <span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>ci.basic <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>ci.perc <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>ci.bca <span class="ot">&lt;-</span> ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The normal interval is&quot;</span>, ci.norm[<span class="dv">1</span>], ci.norm[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## The normal interval is 36.30011 182.3185</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The basic interval is&quot;</span>, ci.basic[<span class="dv">1</span>], ci.basic[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## The basic interval is 20.41667 168.3333</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The percentile interval is&quot;</span>, ci.perc[<span class="dv">1</span>], ci.perc[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## The percentile interval is 47.83333 195.75</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The BCa interval is&quot;</span>, ci.bca[<span class="dv">1</span>], ci.bca[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## The BCa interval is 59.114 241.4204</code></pre>
<p>We can see that the four intervals are different, this is mainly
because that the number of samples we have is too small.</p>
<p>Ideally, when <span class="math inline">\(n\)</span> is large enough,
the four intervals are supposed to approximate the true confidence
interval, but because of the problem mentioned before, the normality
cannot be justified in the normal method, and in the basic method, <span class="math inline">\(\hat\theta^*-\hat\theta|\textbf{X}\)</span> and
<span class="math inline">\(\hat\theta-\theta\)</span> cannot
approximate sufficiently, also <span class="math inline">\(\hat\theta^*|\textbf{X}\)</span> and <span class="math inline">\(\hat\theta\)</span> cannot approximate
sufficiently in the percentile method, which naturally leads to failure
of <code>BCa</code>. Thus the four intervals are quite different.</p>
</div>
<div id="a-use-monte-carlo-to-estimate-coverage-probability" class="section level3">
<h3>7.A: Use Monte Carlo to estimate coverage probability</h3>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
<p>We will give a function to output all the required results with
arguments</p>
<ul>
<li><span class="math inline">\(n\)</span>: the number of samples we
have,</li>
<li><span class="math inline">\(\mu\)</span>: the mean of the normal
distribution,</li>
<li><span class="math inline">\(\sigma\)</span>: the standard deviation
of the normal distribution,</li>
<li><span class="math inline">\(R\)</span>: the replication times of
bootstrap,</li>
<li><span class="math inline">\(m\)</span>: the replication times of
Monte Carlo.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sam_ge <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, sigma){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>sam_an <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, sigma, R, m){</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  mymean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">mean</span>(x[i])</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> C <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">sam_ge</span>(n, mu, sigma)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x, <span class="at">statistic=</span>mymean, <span class="at">R=</span>R)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    ci.norm <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    ci.basic <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    ci.perc <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(ci.norm[<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[<span class="dv">2</span>]<span class="sc">&gt;=</span>mu) C[<span class="dv">1</span>] <span class="ot">&lt;-</span> C[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(ci.norm[<span class="dv">1</span>]<span class="sc">&gt;</span>mu) L[<span class="dv">1</span>] <span class="ot">&lt;-</span> L[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(ci.basic[<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[<span class="dv">2</span>]<span class="sc">&gt;=</span>mu) C[<span class="dv">2</span>] <span class="ot">&lt;-</span> C[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(ci.basic[<span class="dv">1</span>]<span class="sc">&gt;</span>mu) L[<span class="dv">2</span>] <span class="ot">&lt;-</span> L[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(ci.perc[<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[<span class="dv">2</span>]<span class="sc">&gt;=</span>mu) C[<span class="dv">3</span>] <span class="ot">&lt;-</span> C[<span class="dv">3</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(ci.perc[<span class="dv">1</span>]<span class="sc">&gt;</span>mu) L[<span class="dv">3</span>] <span class="ot">&lt;-</span> L[<span class="dv">3</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(C, L))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>sam_res <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>, R, m){</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">sam_an</span>(n, mu, sigma, R, m)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> res[[<span class="dv">1</span>]]<span class="sc">/</span>m</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  pro_L <span class="ot">&lt;-</span> res[[<span class="dv">2</span>]]<span class="sc">/</span>m</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  pro_R <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>rate<span class="sc">-</span>pro_L</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;method&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>), <span class="st">&quot;coverage rate&quot;</span><span class="ot">=</span>rate, <span class="st">&quot;left miss&quot;</span><span class="ot">=</span>pro_L, <span class="st">&quot;right miss&quot;</span><span class="ot">=</span>pro_R))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We will experiment under different <span class="math inline">\(n\)</span>.</p>
<pre><code>## [1] &quot;n=10, R=100, m=1000&quot;</code></pre>
<table style="width:75%;">
<colgroup>
<col width="18%" />
<col width="22%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">method</th>
<th align="center">coverage.rate</th>
<th align="center">left.miss</th>
<th align="center">right.miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">normal</td>
<td align="center">0.9</td>
<td align="center">0.043</td>
<td align="center">0.057</td>
</tr>
<tr class="even">
<td align="center">basic</td>
<td align="center">0.908</td>
<td align="center">0.039</td>
<td align="center">0.053</td>
</tr>
<tr class="odd">
<td align="center">percentile</td>
<td align="center">0.904</td>
<td align="center">0.038</td>
<td align="center">0.058</td>
</tr>
</tbody>
</table>
<pre><code>## [1] &quot;n=1000, R=100, m=1000&quot;</code></pre>
<table style="width:75%;">
<colgroup>
<col width="18%" />
<col width="22%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">method</th>
<th align="center">coverage.rate</th>
<th align="center">left.miss</th>
<th align="center">right.miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">normal</td>
<td align="center">0.929</td>
<td align="center">0.033</td>
<td align="center">0.038</td>
</tr>
<tr class="even">
<td align="center">basic</td>
<td align="center">0.932</td>
<td align="center">0.032</td>
<td align="center">0.036</td>
</tr>
<tr class="odd">
<td align="center">percentile</td>
<td align="center">0.948</td>
<td align="center">0.026</td>
<td align="center">0.026</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-5" class="section level2">
<h2>2022/10/21</h2>
<p>Exercises 7.8, 7.11, 8.2. (pages 212-213, 242, Statistical Computing
with R).</p>
<div id="use-jackknife-to-estimate-bias-and-standard-error" class="section level3">
<h3>7.8: Use Jackknife to estimate bias and standard error</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>value</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>value</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="fu">var</span>(theta.jack)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(variance)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The bias is:&quot;</span>, bias)</span></code></pre></div>
<pre><code>## The bias is: 0.001069139</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The standard error is:&quot;</span>, sd)</span></code></pre></div>
<pre><code>## The standard error is: 0.04955231</code></pre>
</div>
<div id="implement-leave-two-out" class="section level3">
<h3>7.11: Implement leave-two-out</h3>
<p>Use leave-two-out cross validation to compare the models.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)  </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co"># all possible combination</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># leave-two-out cross validation</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span><span class="fu">c</span>(i,j)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 1: Linear</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    e1[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 2：Quadratic</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    e2[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 3: Exponential</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    e3[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 4: Log-Log</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    e4[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    h<span class="ot">&lt;-</span>h<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co"># the average squared prediction error by leave-two-out cross validation</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">Linear=</span><span class="fu">sum</span>(e1), <span class="at">Quadratic=</span><span class="fu">sum</span>(e2), <span class="at">Exponential=</span><span class="fu">sum</span>(e3), <span class="at">LogLog=</span><span class="fu">sum</span>(e4))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>N)</span></code></pre></div>
<pre><code>##      Linear   Quadratic Exponential      LogLog 
##    19.57227    17.87018    18.45491    20.46718</code></pre>
</div>
<div id="implement-the-bivariate-spearman-rank-correlation-test" class="section level3">
<h3>8.2: Implement the bivariate Spearman rank correlation test</h3>
<p><strong>Q</strong>: Implement the bivariate Spearman rank correlation
test for independence as a permutation test. The Spearman rank
correlation test statistic can be obtained from function
<code>cor</code> with <code>method = &quot;spearman&quot;</code>. Compare the
achieved significance level of the permutation test with the p-value
reported by <code>cor.test</code> on the same samples.</p>
<p><strong>A</strong>: Spearman’s rank correlation coefficient or
Spearman’s <span class="math inline">\(\rho\)</span> is a nonparametric
measure of statistical dependence between the rankings of two variables,
using that to be a test statistic we can get independence test as
below:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(z){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  rho <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i){</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> data[,<span class="dv">1</span>]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> data[i,<span class="dv">2</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    rho <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="co"># in bivariate case, it equals to Spearman&#39;s rank correlation coefficient</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(rho)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  rhos <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>rho, <span class="at">R=</span><span class="dv">9999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)<span class="sc">$</span>t</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  rho0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(z[,<span class="dv">1</span>], z[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="fu">sum</span>(rhos<span class="sc">&gt;=</span>rho0)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co">#almost independent samples</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test pvalue:&quot;</span>, <span class="fu">cor.test</span>(z1[,<span class="dv">1</span>], z1[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## cor.test pvalue: 0.8522426</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;our spearman test pvalue:&quot;</span>, <span class="fu">spearman</span>(z1))</span></code></pre></div>
<pre><code>## our spearman test pvalue: 0.4298</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))<span class="co"># dependent samples</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test pvalue:&quot;</span>, <span class="fu">cor.test</span>(z2[,<span class="dv">1</span>], z2[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## cor.test pvalue: 0.01775129</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;our spearman test pvalue:&quot;</span>, <span class="fu">spearman</span>(z2))</span></code></pre></div>
<pre><code>## our spearman test pvalue: 0.0094</code></pre>
<p>Both tests give the same test results and the p-values are close
enough.</p>
</div>
</div>
<div id="section-6" class="section level2">
<h2>2022/10/28</h2>
<p>Exercises 9.4, 9.7. (pages 277-278, Statistical Computing with
R).</p>
<div id="implement-random-walk-metropolis-sampler" class="section level3">
<h3>9.4: Implement random walk Metropolis sampler</h3>
<p><strong>Q</strong>: Implement a random walk Metropolis sampler for
generating the standard Laplace distribution (see Exercise 3.2). For the
increment, simulate from a normal distribution. Compare the chains
generated when different variances are used for the proposal
distribution. Also, compute the acceptance rates of each chain.</p>
<p><strong>A</strong>: The standard Laplace distribution has density
<span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>, using
normal increment, we can get the proposal density <span class="math inline">\(N(X_t, \sigma^2)\)</span>. Below we will set <span class="math inline">\(\sigma\)</span> to be <span class="math inline">\(0.1,1,10,100,1000\)</span> and compare the
acceptance rates of each chain and the Gelman-Rubin statistics of
different variances.</p>
<ul>
<li>The chain generation function and Gelman-Rubin statistics
calculation function.</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#chain generation</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>MCMC <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, g, f, n, sigma){</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">g</span>(xt, y, sigma)<span class="sc">/</span>(<span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">g</span>(y, xt, sigma))</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u<span class="sc">&lt;=</span>r){</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chain=</span>x, <span class="at">acc=</span>k<span class="sc">/</span>n))</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi) <span class="co">#psi is the cumulative-mean-value matrix </span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, var)</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>B<span class="sc">/</span>(n<span class="sc">*</span>k)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat<span class="sc">/</span>W</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>The simulation and acceptance rates.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate the samples</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x, xt, sigma){</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, xt, sigma)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>), MCMC, g, f, <span class="dv">15000</span>, <span class="fl">0.1</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span>(i<span class="dv">-1</span>))</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  X[[i]] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">$</span>chain, x[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">$</span>chain, x[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">$</span>chain)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  accept[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(x[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">$</span>acc, x[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">$</span>acc, x[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">$</span>acc)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">#The acceptance rate</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>acceptance_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;0.1&quot;</span><span class="ot">=</span>accept[[<span class="dv">1</span>]],</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;1&quot;</span><span class="ot">=</span>accept[[<span class="dv">2</span>]],</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;10&quot;</span><span class="ot">=</span>accept[[<span class="dv">3</span>]],</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;100&quot;</span><span class="ot">=</span>accept[[<span class="dv">4</span>]],</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;1000&quot;</span><span class="ot">=</span>accept[[<span class="dv">5</span>]])</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(acceptance_rate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x0=0&quot;</span>, <span class="st">&quot;x0=5&quot;</span>, <span class="st">&quot;x0=10&quot;</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(acceptance_rate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma=0.1&quot;</span>, <span class="st">&quot;sigma=1&quot;</span>, <span class="st">&quot;sigma=10&quot;</span>, <span class="st">&quot;sigma=100&quot;</span>, <span class="st">&quot;sigma=1000&quot;</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(acceptance_rate)</span></code></pre></div>
<table style="width:97%;">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="13%" />
<col width="15%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">sigma=0.1</th>
<th align="center">sigma=1</th>
<th align="center">sigma=10</th>
<th align="center">sigma=100</th>
<th align="center">sigma=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>x0=0</strong></td>
<td align="center">0.9611</td>
<td align="center">0.6967</td>
<td align="center">0.1515</td>
<td align="center">0.01573</td>
<td align="center">0.002333</td>
</tr>
<tr class="even">
<td align="center"><strong>x0=5</strong></td>
<td align="center">0.9629</td>
<td align="center">0.694</td>
<td align="center">0.1512</td>
<td align="center">0.01573</td>
<td align="center">0.0028</td>
</tr>
<tr class="odd">
<td align="center"><strong>x0=10</strong></td>
<td align="center">0.9637</td>
<td align="center">0.6972</td>
<td align="center">0.1557</td>
<td align="center">0.0156</td>
<td align="center">0.0024</td>
</tr>
</tbody>
</table>
<ul>
<li>Gelman-Rubin.</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X[[j]], <span class="dv">1</span>, cumsum))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i,] <span class="ot">&lt;-</span> psi[i,]<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  R[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;sigma0.1&quot;</span><span class="ot">=</span>R[<span class="dv">1</span>], <span class="st">&quot;sigma1&quot;</span><span class="ot">=</span>R[<span class="dv">2</span>], <span class="st">&quot;sigma10&quot;</span><span class="ot">=</span>R[<span class="dv">3</span>], <span class="st">&quot;sigma100&quot;</span><span class="ot">=</span>R[<span class="dv">4</span>], <span class="st">&quot;sigma1000&quot;</span><span class="ot">=</span>R[<span class="dv">5</span>]))</span></code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="15%" />
<col width="12%" />
<col width="13%" />
<col width="15%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">sigma0.1</th>
<th align="center">sigma1</th>
<th align="center">sigma10</th>
<th align="center">sigma100</th>
<th align="center">sigma1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.278</td>
<td align="center">1.061</td>
<td align="center">1.08</td>
<td align="center">1.11</td>
<td align="center">1.087</td>
</tr>
</tbody>
</table>
<p>We can see that when <span class="math inline">\(\sigma=1\)</span>
the chains mix the best with acceptance rate around 0.7, which is a nice
choice. Below we print the trace plot of 5 groups of chains for better
visual comparison.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X[[i]])) <span class="fu">plot</span>(X[[i]][j,], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fl">0.1</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span>(i<span class="dv">-1</span>), <span class="at">ylab=</span><span class="st">&quot;value&quot;</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="implement-gibbs-sampler" class="section level2">
<h2>9.7: Implement Gibbs sampler</h2>
<p><strong>Q</strong>: Implement a Gibbs sampler to generate a bivariate
normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero
means, unit standard deviations, and correlation 0.9. Plot the generated
sample after discarding a suitable burn-in sample. Fit a simple linear
regression model <span class="math inline">\(Y = \beta_0 +
\beta_1X\)</span> to the sample and check the residuals of the model for
normality and constant variance.</p>
<p><strong>A</strong>: It is clear that <span class="math display">\[(X_t,Y_t)\sim N(\mathbb{0},\Sigma),\quad
\Sigma=\left( \begin{matrix}
    1&amp;      0.9\\
    0.9&amp;        1\\
\end{matrix} \right). \]</span> Thus we can easily calculate <span class="math display">\[X_t|Y_t\sim N(0.9Y_t, 0.19).\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gibbs generation function</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, n){</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(x0)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  sam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">numeric</span>(p<span class="sc">*</span>n), <span class="at">nrow =</span> n)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  sam[<span class="dv">1</span>,] <span class="ot">&lt;-</span> x0</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">0.19</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    sam[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>sam[i<span class="dv">-1</span>,<span class="dv">2</span>], sig)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    sam[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>sam[i,<span class="dv">1</span>], sig)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sam)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate samples</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">8</span>), <span class="at">byrow =</span> T, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>sams <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) sams[[i]] <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>(X0[i,], <span class="dv">15000</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate R_x and R_y</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sams[[<span class="dv">1</span>]][,<span class="dv">1</span>], sams[[<span class="dv">2</span>]][,<span class="dv">1</span>], sams[[<span class="dv">3</span>]][,<span class="dv">1</span>])</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>psi_x <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi_x)) psi_x[j,] <span class="ot">&lt;-</span> psi_x[j,]<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi_x)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sams[[<span class="dv">1</span>]][,<span class="dv">2</span>], sams[[<span class="dv">2</span>]][,<span class="dv">2</span>], sams[[<span class="dv">3</span>]][,<span class="dv">2</span>])</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>psi_y <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(y, <span class="dv">1</span>, cumsum))</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi_y)) psi_y[j,] <span class="ot">&lt;-</span> psi_y[j,]<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi_y)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;x&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi_x), <span class="st">&quot;y&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi_y), <span class="at">row.names =</span> <span class="st">&quot;R&quot;</span>))</span></code></pre></div>
<table style="width:35%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>R</strong></td>
<td align="center">1.038</td>
<td align="center">1.048</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x[i,<span class="dv">5000</span><span class="sc">:</span><span class="dv">15000</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x_trace&quot;</span>, <span class="at">xlab=</span>x[i,<span class="dv">1</span>])</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(y[i,<span class="dv">5000</span><span class="sc">:</span><span class="dv">15000</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;y_trace&quot;</span>, <span class="at">xlab=</span>y[i,<span class="dv">1</span>])</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We use chain1, that is, x0=(0,0) chain to do regression</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span>  y[<span class="dv">1</span>,<span class="dv">5000</span><span class="sc">:</span><span class="dv">15000</span>]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>,<span class="dv">5000</span><span class="sc">:</span><span class="dv">15000</span>]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////GkoVkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI10lEQVR4nO2dD5+iNhCGs9e9a9f27Nrac5Xv/z0rQkJA4J0ZEoj6Pv311tuLk+FxEv4KriKzuK0TKB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFkFfP34mz6NYNILOOxf49u94uIchh6Dq5D7qHzMVVOyIHSrJI+haQ++/xgTpP5iVcdVgUTMJqqrD2+fjVFD4wFz0Z3X3ej6GttOj+3gUQV3ZrCnoWj+/PYagyMqqgqrL3j2aoBXnoHXDqboeriFc/OuV1mJrh1P2PGJo5Nfh38RxE7KZoPtZpurKZiQrCmr+3iiiIF8sLv5L87N+SUHXfpv/bq8bJ677OfoGceSkbCToVj1+PLl2aDn/ioKCENfWUbRv2Pzu/h3i0Cnz3LaC2jpqR1dQ5kaH2WsJaqumq5wq+hEmJVuiTyJoUDR3FdSl5resFbETp7oy84cNo6NU/Z2ylxF0XzdjnkJq4eWrCAJm2tln5MDQ0wpy/fURFhQ2i6L8nljQYPqQ+em94z4I7jEhmQX5AnDxOn1aTRhjcYinXov5na1KVjxdDdkT1S3R8drd7XDrcerEoSqcmubDF5VPqKKZSOIupRzfPqvz7nu1maB2k1CqZ2Y2ziLosv+4/fn+azNBsu2e2NCags675mzG4f3XQND8eE+K1E2TzGRCGSvoyuH7thUkrp/pDyzTHNRqOe8mr+7QhNOikePmxpcmUe1arBlkl/2aglw4taVlJqa48+X5ZwwXYkaHUcX1M1dATyTIabZ64tp5EUHREVSlITe7Sn0WQabqceE4a4JEyxZkkhMcJUm0aEHG0SXZXH0KQRn9PIkgq6GUiZYtSCum1fMiQ8xWPa8jyO7n+QU5f9FBNj+PLci4dVi5Cm5A6xMtUJD3o7Y0c3zMnmiRgiz148ABIGuiJQqyb//Iu39YQdbimbzWbmmihQky7707xfyjSrQsQebpx6nGlybRpqHgy5Y3LnvQZpkguxx139oKmjwK3+Po2vM+J//C3O/4m5cUj65r9RC77L/DtuG82FVV/dXMJf2OvNVeP+LNQ0OioeFp+ktgHn9mtW6d/MzqAjuWjyXvmdX0FWQvH/3o0iWqO7Pqqyz1HLS6n1yreb+2m6gfqyC7HcPso0w0NLwuO56m0/Xbe5N532LBlGdoWF8+NjFy0vfbe4+9fvIn2m+42JE2ZXvxGLZ9TIkOG9aKJNuMS/ttm7fLalO0vqCTq6/RvF1jl7vfpvVtIa2ouzMl2jWs11CNmZO9hPTb+9v4Ma3F3j7t/en7tV3V0rrx/6+R6IJOFoRbYMctM6NMdBtBLv7i5BZ6Chd0981blZ3nF+SqcAbLUjwvIWjR3unzC3L2fa9UfkoW5Bas4Beu23WJKhumCmfVk2ryESeqbZgoXDS4DOfeV0xU3TBROOP6K22WkkTVDROFs9RO6iRFiaobpgpnKJ4Mfp5HUPSd95UT1TZMFU5bPlWWEVauIKWe1Gt3eaLqhvNR4o9c1lDix1XptgyHiSRvmCKcSk67y5Y2P2Giloa2cL0l1K3e0yaGEl3e0BSud+BYt4+RNi+UaIKGlnCu9zvVYY60aaFEUzS0hOsJcuLd1Exr9plEUzS0hAuCmsWW7GP4A9a5KUNQGFXC+sm96ppONEFDW7gwYkRjaw0zE4kub2gM5+IzPHBfPm0yqkQXN7SF85c43VkZs5Q2FV2iyxuawjW7UqUNr5FEEzQ0hZMI8qu4tIkoE03Q0BTOr7mquXPN2u+h5Eg0QUNbOOcm5qBoYGU6ZqhLdHlDW7ioQu5qxrUNtvBTjqDKb/gNh1VovP7w8omlbagIFy1ycBDVjt+43qJwAlsKipbdiwhWnD9OmKFvFVkFzT8+K9qFj4ZWV0ZFFFAeQZJnHMYzi39V+SmnO5CxwYq9T54KEj3jsJ2G/DgKRzviwtlWTqXJQJfq1DMOe+EGc0y3Ne3bbFw8TRLJG7ZInnHoDfgr5lwBQ2pIvkla9IxDXzvd7FzCsIrJuBYbe8ZhvOcQwrr4H19IkOwZhz1X3YxdDHkFTX9jaiRct7dREoUJKm2AFSWokA2fASUJKnCAFSaoRDbbm38YNhKkjy1LIF0o7QJTUOL2yWNTUJIEKGi1UBSUpD97++SxKShJAhS0WqiSBD0FFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJBZ0AHds/J2l3xwd9STc/AWhpI4sowG5BV0mr6xcsNlf1304/x9iE/XJidgSBJHltGQrILOO5ROcy3W1JOjbzQncg/zyy6II8xoSFZBx/e/RenM1od02VEcVUYdOQV9/f4pG/GHuaW/RqmE95edjaPKqCOjoHpsiNKZvEN+86+3ssDFgeJoMorIKKh+coIknROeo0WCQBxFRjH5BN2GhiAd9LlLhxisH3FGPbIIut35/dheZzJ1wWd7e/gjWi7hJA3jND3OZTTK1huKR5iuaDUviCPNaMDGgr5+4K1fyYaiJI4soyEbC2qrfn7xj3hXQxRHlNEQ7qwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYAHEfT1h/kJ7wt5DEHnneQSxSw8hKDT5L1j81OyoPqqsvPuo764TnSRaxZKFlRfW3ZsLuehoFFO3/7587N9RUFjHPyVvRQ0zslfmklBo1z2f7ViKGiU4/t/7T0bKWiM8+6nN0NBY9RX7F72t2magoqFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A+QjupWIipEXQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(c1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1<span class="sc">~</span>x1))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x1)
## 
## Coefficients:
## (Intercept)           x1  
##  -1.566e-05    9.009e-01</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(c1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As is shown in the Q-Q plot, the residual is normally distributed. As
is shown in the Residual vs Fitted plot, the error variance is
constant.</p>
</div>
<div id="section-7" class="section level2">
<h2>2022/11/5</h2>
<p>Conduct the two simulations in “HW8.pdf”.</p>
<div id="mediantion-effect" class="section level3">
<h3>8.1: Mediantion effect</h3>
<p>We will conduct the simulation following the steps mentioned in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6982415/">Kroehl ME,
Lutz S, Wagner BD. Permutation-based methods for mediation analysis in
studies with small sample sizes. PeerJ. 2020 Jan 22;8:e8246. doi:
10.7717/peerj.8246. PMID: 32002321; PMCID: PMC6982415.</a></p>
<ol style="list-style-type: decimal">
<li>Fit the full model to calculate <span class="math inline">\(T_0\)</span>.</li>
<li>Fit the reduced model under different hypothesis and permute the
residuals.</li>
<li>Use the permuted residuals to fit the full model again with <span class="math inline">\(Y\)</span> and <span class="math inline">\(M\)</span> replaced by <span class="math inline">\(Y^*\)</span> and <span class="math inline">\(M^*\)</span>.</li>
</ol>
<ul>
<li>data generation and simulation function.</li>
</ul>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>generation <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, am, ay, n, <span class="at">gamma=</span><span class="dv">1</span>){</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, am, <span class="dv">1</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> ay <span class="sc">+</span> gamma<span class="sc">*</span>x <span class="sc">+</span> ey </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, am, <span class="dv">1</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> ay <span class="sc">+</span> gamma<span class="sc">*</span>x <span class="sc">+</span> ey <span class="sc">+</span> m </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, am, <span class="dv">1</span>) <span class="sc">+</span> x</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> ay <span class="sc">+</span> gamma<span class="sc">*</span>x <span class="sc">+</span> ey </span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">m=</span>m))</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, x, y, m, B){</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># full model</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reduced model</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(condition<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># permutation</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>  mhat <span class="ot">&lt;-</span> fit3<span class="sc">$</span>fitted.values</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> fit4<span class="sc">$</span>fitted.values</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>  rm <span class="ot">&lt;-</span> fit3<span class="sc">$</span>residuals</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>  ry <span class="ot">&lt;-</span> fit4<span class="sc">$</span>residuals</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(rm)</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>    lab <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">c</span>(rm, ry)[lab]</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    rmstar <span class="ot">&lt;-</span> r[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>    rystar <span class="ot">&lt;-</span> r[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>    mstar <span class="ot">&lt;-</span> mhat <span class="sc">+</span> rmstar</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>    ystar <span class="ot">&lt;-</span> yhat <span class="sc">+</span> rystar</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>    fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mstar<span class="sc">~</span>x)</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>    fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ystar<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>    alpha[i] <span class="ot">&lt;-</span> fit3<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>    beta[i] <span class="ot">&lt;-</span> fit4<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>  alpha0 <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>  beta0 <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> alpha<span class="sc">*</span>beta</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> alpha0<span class="sc">*</span>beta0</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(t)<span class="sc">&gt;=</span>t0)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Conduct the simulation</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters condition 1</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">generation</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> data<span class="sc">$</span>m</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 1</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">1</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 2</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">2</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 3</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">3</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters condition 2</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">generation</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> data<span class="sc">$</span>m</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 1</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>p21 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">1</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 2</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">2</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 3</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>p23 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">3</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters condition 3</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">generation</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> data<span class="sc">$</span>m</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 1</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>p31 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">1</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 2</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>p32 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">2</span>, x, y, m, <span class="dv">500</span>)</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation condition 3</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>p33 <span class="ot">&lt;-</span> <span class="fu">simulation</span>(<span class="dv">3</span>, x, y, m, <span class="dv">500</span>)</span></code></pre></div>
<ul>
<li>print the result</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(p11, p12, p13)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(p21, p22, p23)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">c</span>(p31, p32, p33)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p1, p2, p3)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(p)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H1&quot;</span>, <span class="st">&quot;H2&quot;</span>, <span class="st">&quot;H3&quot;</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;D1&quot;</span>, <span class="st">&quot;D2&quot;</span>, <span class="st">&quot;D3&quot;</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(p)</span></code></pre></div>
<table style="width:33%;">
<colgroup>
<col width="12%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">H1</th>
<th align="center">H2</th>
<th align="center">H3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D1</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>D2</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>D3</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>Here, <span class="math inline">\(D_i\)</span> means generating data
under condition <span class="math inline">\(i\)</span>, that is</p>
<ul>
<li><span class="math inline">\(D_1\)</span> for <span class="math inline">\(\alpha=0,\ \beta=0\)</span></li>
<li><span class="math inline">\(D_2\)</span> for <span class="math inline">\(\alpha=0,\ \beta=1\)</span></li>
<li><span class="math inline">\(D_3\)</span> for <span class="math inline">\(\alpha=1,\ \beta=0\)</span></li>
</ul>
<p>So the three data-sets all obey hypothesis <span class="math inline">\(\alpha\beta=0\)</span>, however, according to the
simulation result, three kinds of permutation all fail to control the
Type 1 error rate under all data-sets, <span class="math inline">\(H_1\)</span> fails on <span class="math inline">\(D_3\)</span>, <span class="math inline">\(H_2\)</span> fails on <span class="math inline">\(D_2\)</span>, <span class="math inline">\(H_3\)</span> fails on <span class="math inline">\(D_2\)</span> and <span class="math inline">\(D_3\)</span>.</p>
</div>
<div id="determine-parameter-in-logit-regression" class="section level3">
<h3>8.2: Determine parameter in logit regression</h3>
<ol style="list-style-type: decimal">
<li>Following the tips on P9, Numerical Methods in R, we will solve
<span class="math inline">\(\alpha\)</span> by finding root of <span class="math inline">\(g(\alpha)\)</span>.</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the function</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>Falpha <span class="ot">&lt;-</span> <span class="cf">function</span>(f0, N, b1, b2, b3){</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  solution<span class="sc">$</span>root</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Implement (2) and (3).</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-1</span>, <span class="fl">1e-2</span>, <span class="fl">1e-3</span>, <span class="fl">1e-4</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">vapply</span>(f0, Falpha, <span class="dv">1</span>, <span class="at">N=</span><span class="fl">1e6</span>, <span class="at">b1=</span><span class="dv">0</span>, <span class="at">b2=</span><span class="dv">1</span>, <span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0, alpha)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQZgCQ2/+2ZgC225C2///bkDrb////tmb/25D//7b//9v////TcgzxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFiUlEQVR4nO3dD3OaSABAcS5J75JLr16oSf3+n/T4o552wLfArrvC+820E5PAtm8QUFepDrqpyv0PKJ2BgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBQORA1cPIFSju6hI4tjHQiOriT/ACkccvWXX620DDDAQMRNwHEY9iYQwEDAQMBAwEDAQMBO4caPqzCLm5BQEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQOBRIF2Tx+Hz29V9cePKKvLKE2grs+fTZyvt/cIq8spSaCvt9cm0kv7Zf38c/HqspoR6Outf12i2UpGtNvNr++v7Zf7kd9ac6Dd88/6pdnDjNx5ul9ptp56+hZU4qtB0wO19599898e+6/3v/P00W1C+7G99NC4k+Yr3cucQO+Hz78+uj/j9v3d8OX3tdx44bC6+Lsc0wO1W8bX3z8g0Ixx1xLoUDf73d3rzbtY77ifDh13NYHaXXBzJBs/iJ1MDLSWfVC4qYFWchQLNzlQiWYE+vWdThTPv7jNQDve+0QcN7d5J4p3HDe3eSeKdxw3tzknir+fHicdN7cZ+6CbD1Ojj5vbxECnpzqCjmJRxs3N56SBgcCcQN39DB+qRho3txmB+ifB6tEXLOKOm9ucw3x/ENst2oZWHKh9sqw19nR85HFzm78F8RNmUcbNbc4+qGoL1dWi08UVB4pzrrjiQHceNzcDAQMBH6yCO29BviUz0+rSSTL9Jea4uaWZ/hJx3NzSTH+JOG5uqaa/RBs3t8zTX8o/nKWc/sKrK3I+x7WU019wdWXOCLqW9TzIQLA6A9HqVroPijjuKo9i9x03NwOBRIFwmt7GA9XVcRbavhqZjrbtQBezN7f4dih2MUtvi2+HYm5B5Pyyq/ugEaenZUcf8W890L1Xl46BgIGALxyCROdB+AL1tgM1J0L0hOzGA/EbOrYe6DhPL9rq8vEoBgwEUgba6ntWgxkIGAgYCBjoHuPmlve1+Qd4zJoz0AO8Mp810CPM7TAQMhBwHwQ8igHPg0C2QA8jU6CwlcLPl/146eLLfj3OSg207OcGMtCynxvIQMt+biADLfv5+gOtiYGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBQKRA+8sLQ55v7G9cLjJg8UPoZxMPL15X1bLPXe3ECdR+FvX5omznG1ffnb54+3XQB4APL95+MjbNew8QJVA/Ka+/POT/N66+O33xQ/fumYBAY6O/hI0OogTqPxmu7t/pcr5x9d3pi7d/P/8TEGh48bICtddePb1V/Hzj6rvTF+++DNkHjSxe0l2s3wEcdwPnG1ffnb54d28JCTSyePgh4qaCA7XvzV8QqL/s8uIrOpV7F+u+mH8XC94DgnJ30vVxngruRYYXD95+QdGH+bAtaHjxvtSyazy0yj5RDDuTHl68pH1Qd1rf/qP6k4/64mQ/bBMfXvwQ+lBjePFdc/9cftU9H6wCAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDgbID1e2r63Fmis1VdKD24rjhc0TSKDzQe/gso0RKDvT5raqe/o00lW6ukgP1l1cOnemYSPGBYs01nMtAoPhA3sVu6AK5kx7nYR50F1X0RHFcf9XJ4MnESRQdqAQGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYC/wG9QOYpMwBu/QAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0), alpha)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-8" class="section level2">
<h2>2022/11/11</h2>
<ol style="list-style-type: decimal">
<li>Class work</li>
<li>2.1.3 Exercise 4, 5 (Pages 19 Advanced in R)</li>
<li>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</li>
<li>2.4.5 Exercise 1, 2, 3 (Pages 30 Advanced in R)</li>
</ol>
<div id="class-work" class="section level3">
<h3>Class work</h3>
<p>The log-likelihood of the observed data is <span class="math display">\[l\left( \lambda \right) =\sum_{i=1}^n{\log \left(
e^{-\lambda u_i}-e^{-\lambda v_i} \right)},\]</span> its first
derivative and second derivative are <span class="math display">\[\frac{\mathrm{d}l}{\mathrm{d}\lambda}\left(
\lambda \right) =\sum_{i=1}^n{\frac{-u_ie^{-\lambda u_i}+v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}},\]</span> <span class="math display">\[\frac{\mathrm{d}^2l}{\mathrm{d}\lambda ^2}\left(
\lambda \right) =\sum_{i=1}^n{\frac{-\left( u_i+v_i \right)
^2e^{-\lambda \left( u_i+v_i \right)}}{\left( e^{-\lambda
u_i}-e^{-\lambda v_i} \right) ^2}&lt;0},\]</span> which means that <span class="math inline">\(\hat{\lambda}_{\mathrm{MLE}}\)</span> is the root
of <span class="math inline">\(\frac{\mathrm{d}l}{\mathrm{d}\lambda}\left(
\lambda \right)\)</span>.</p>
<p>As for the EM algorithm, the log-likelihood of the full data is <span class="math display">\[l\left( \lambda \right) =n\log \lambda -\lambda
\sum_{i=1}^n{X_i},\]</span> it is easily to get the maximum of it, which
leads to <span class="math display">\[\hat{\lambda}_{\mathrm{MLE}}=\frac{1}{\bar{X}},\]</span>
in this case. According to EM algorithm, we get <span class="math display">\[E\left[ X_i|u_i\leqslant X_i\leqslant v_i \right]
=\frac{1}{\lambda}-\frac{-u_ie^{-\lambda u_i}+v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}.\]</span> Thus we can get the
recurrence formula EM to be <span class="math display">\[\lambda
_{n+1}=\frac{n}{\frac{n}{\lambda _n}-\sum_{i=1}^n{\frac{-u_ie^{-\lambda
_nu_i}+v_ie^{-\lambda _nv_i}}{e^{-\lambda _nu_i}-e^{-\lambda
_nv_i}}}},\]</span> if the limit of <span class="math inline">\(\{\lambda_n\}\)</span> exists, the formula leads
to the same result of MLE, i.e. <span class="math inline">\(\hat{\lambda}_{\mathrm{EM}}\)</span> is the root
of <span class="math inline">\(\sum_{i=1}^n{\frac{-u_ie^{-\lambda
u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}}\)</span>,
which is exactly the first derivative of log-likelihood of the observed
data. Below, we will complete the existence of the limit. Let <span class="math display">\[f\left( \lambda \right)
=\frac{n}{\frac{n}{\lambda}-\sum_{i=1}^n{\frac{-u_ie^{-\lambda
u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}}},\]</span>
clearly <span class="math inline">\(f\)</span> is a restrictively
decreasing function, so <span class="math inline">\(\lambda_n\)</span>
is a decreasing series with lower bound <span class="math inline">\(0\)</span>, so <span class="math inline">\(\lambda_n\)</span> converges.</p>
<p>Code:</p>
<ul>
<li>MLE:</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, u, v){</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> (<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">+</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(tab)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> u<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>(lambda <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(MLE, <span class="fu">c</span>(<span class="fl">1e-5</span>, <span class="dv">10</span>), <span class="at">u=</span>u, <span class="at">v=</span>v)<span class="sc">$</span>root)</span></code></pre></div>
<pre><code>## [1] 0.07196822</code></pre>
<ul>
<li>EM:</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda0, u, v){</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tab<span class="sc">&gt;</span><span class="fl">1e-6</span><span class="sc">&amp;</span>k<span class="sc">&lt;=</span><span class="dv">1000</span>){</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    lambda1 <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">/</span>lambda0 <span class="sc">-</span> <span class="fu">sum</span>((<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>u)<span class="sc">+</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda0<span class="sc">*</span>v))))</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    tab <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda0<span class="sc">-</span>lambda1)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    lambda0 <span class="ot">&lt;-</span> lambda1</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda1)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(<span class="dv">1</span>, u, v)</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
</div>
<div id="section-9" class="section level3">
<h3>2</h3>
<p><strong>Q4</strong>: Why do you need to use <code>unlist()</code> to
convert a list to an atomic vector? Why doesn’t <code>as.vector()</code>
work?</p>
<p><strong>A</strong>: This is mainly because that the components in a
<code>list</code> can be of different types, if we use
<code>as.vector</code> to convert such lists to vectors, we will get a
vector consisting of nested structures, instead of an atomic vector.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">b=</span><span class="dv">4</span>, <span class="at">c=</span><span class="st">&quot;c&quot;</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">unlist</span>(a)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;If b is a vector:&quot;</span>, <span class="fu">is.vector</span>(b))</span></code></pre></div>
<pre><code>## If b is a vector: TRUE</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The length of b:&quot;</span>, <span class="fu">length</span>(b))</span></code></pre></div>
<pre><code>## The length of b: 5</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b) </span></code></pre></div>
<pre><code>##  a1  a2  a3   b   c 
## &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;c&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(a)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;If c is a vector:&quot;</span>, <span class="fu">is.vector</span>(c))</span></code></pre></div>
<pre><code>## If c is a vector: TRUE</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The length of c:&quot;</span>, <span class="fu">length</span>(c), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The length of c: 3</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(c)</span></code></pre></div>
<pre><code>## $a
## [1] 1 2 3
## 
## $b
## [1] 4
## 
## $c
## [1] &quot;c&quot;</code></pre>
<p><strong>Q5</strong>: Why is <code>1 == &quot;1&quot;</code> true? Why is
<code>-1 &lt; FALSE</code> true? Why is <code>&quot;one&quot;&lt; 2</code>
false?</p>
<p><strong>A</strong>: This is mainly because that when we do
calculation like <code>1 == &quot;1&quot;</code>, the type of <code>1</code> is
coerced to character, so that comparison is actually between
<code>&quot;1&quot;</code> and <code>&quot;1&quot;</code>, that’s why it comes out to be
<code>TRUE</code>. For <code>-1 &lt; FALSE</code>, logical
<code>FALSE</code> is coerced to integer <code>0</code>, which gives
result <code>TRUE</code>. For <code>&quot;one&quot;&lt; 2</code>, it is obvious
that <code>&quot;one&quot; &lt; &quot;2&quot;</code> is false, according to ASCII encoding
rule.</p>
</div>
<div id="section-10" class="section level3">
<h3>3</h3>
<p><strong>Q1</strong>: What does dim() return when applied to a
vector?</p>
<p><strong>A</strong>: It returns <code>NULL</code>, as vector does not
have attribute <code>dim</code> by default.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p><strong>Q2</strong>: If <code>is.matrix(x)</code> is TRUE, what will
<code>is.array(x)</code> return?</p>
<p><strong>A</strong>: True, because <code>matrix</code> is a subset of
2D <code>array</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="section-11" class="section level3">
<h3>4</h3>
<p><strong>Q1</strong>: What attributes does a data frame possess?</p>
<p><strong>A</strong>: <code>names</code>, <code>class</code>,
<code>row.names</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(<span class="fu">data.frame</span>(a))</span></code></pre></div>
<pre><code>## $names
## [1] &quot;X1&quot; &quot;X2&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2</code></pre>
<p><strong>Q2</strong>: What does <code>as.matrix()</code> do when
applied to a data frame with columns of different types?</p>
<p><strong>A</strong>: It coerces the type of components to type of
higher order.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(a)</span></code></pre></div>
<pre><code>##      name....c..a....b.. age....c.1..3.
## [1,] &quot;a&quot;                 &quot;1&quot;           
## [2,] &quot;b&quot;                 &quot;3&quot;</code></pre>
<p><strong>Q3</strong>: Can you have a data frame with 0 rows? What
about 0 columns?</p>
<p><strong>A</strong>: Yes, we can create data frames of 0 rows and 0
columns as below.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">0</span>, <span class="at">ncol=</span><span class="dv">0</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(a)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  0 variables</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">0</span>, <span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(b)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  1 variable:
##  $ matrix.nrow...0..ncol...1.: logi</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">0</span>))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(c)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1 obs. of  0 variables</code></pre>
</div>
</div>
<div id="section-12" class="section level2">
<h2>2022/11/18</h2>
<ol style="list-style-type: decimal">
<li>Exercises 2 (page 204, Advanced R)</li>
<li>Exercises 1 (page 213, Advanced R)</li>
<li>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9.</li>
</ol>
<div id="section-13" class="section level3">
<h3>1</h3>
<p><strong>Q:</strong> The function below scales a vector so it falls in
the range <span class="math inline">\([0,1]\)</span>. How would you
apply it to every column of a data frame? How would you apply it to
every numeric column in a data frame?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>A:</strong> Use <code>apply</code></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(iris3)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>##   Sepal L..Setosa Sepal W..Setosa Petal L..Setosa Petal W..Setosa
## 1             5.1             3.5             1.4             0.2
## 2             4.9             3.0             1.4             0.2
## 3             4.7             3.2             1.3             0.2
## 4             4.6             3.1             1.5             0.2
## 5             5.0             3.6             1.4             0.2
## 6             5.4             3.9             1.7             0.4
##   Sepal L..Versicolor Sepal W..Versicolor Petal L..Versicolor
## 1                 7.0                 3.2                 4.7
## 2                 6.4                 3.2                 4.5
## 3                 6.9                 3.1                 4.9
## 4                 5.5                 2.3                 4.0
## 5                 6.5                 2.8                 4.6
## 6                 5.7                 2.8                 4.5
##   Petal W..Versicolor Sepal L..Virginica Sepal W..Virginica Petal L..Virginica
## 1                 1.4                6.3                3.3                6.0
## 2                 1.5                5.8                2.7                5.1
## 3                 1.5                7.1                3.0                5.9
## 4                 1.3                6.3                2.9                5.6
## 5                 1.5                6.5                3.0                5.8
## 6                 1.3                7.6                3.0                6.6
##   Petal W..Virginica
## 1                2.5
## 2                1.9
## 3                2.1
## 4                1.8
## 5                2.2
## 6                2.1</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Y)</span></code></pre></div>
<pre><code>##      Sepal L..Setosa Sepal W..Setosa Petal L..Setosa Petal W..Setosa
## [1,]       0.5333333       0.5714286       0.4444444             0.2
## [2,]       0.4000000       0.3333333       0.4444444             0.2
## [3,]       0.2666667       0.4285714       0.3333333             0.2
## [4,]       0.2000000       0.3809524       0.5555556             0.2
## [5,]       0.4666667       0.6190476       0.4444444             0.2
## [6,]       0.7333333       0.7619048       0.7777778             0.6
##      Sepal L..Versicolor Sepal W..Versicolor Petal L..Versicolor
## [1,]           1.0000000           0.8571429           0.8095238
## [2,]           0.7142857           0.8571429           0.7142857
## [3,]           0.9523810           0.7857143           0.9047619
## [4,]           0.2857143           0.2142857           0.4761905
## [5,]           0.7619048           0.5714286           0.7619048
## [6,]           0.3809524           0.5714286           0.7142857
##      Petal W..Versicolor Sepal L..Virginica Sepal W..Virginica
## [1,]               0.500          0.4666667             0.6875
## [2,]               0.625          0.3000000             0.3125
## [3,]               0.625          0.7333333             0.5000
## [4,]               0.375          0.4666667             0.4375
## [5,]               0.625          0.5333333             0.5000
## [6,]               0.375          0.9000000             0.5000
##      Petal L..Virginica Petal W..Virginica
## [1,]          0.6250000          1.0000000
## [2,]          0.2500000          0.4545455
## [3,]          0.5833333          0.6363636
## [4,]          0.4583333          0.3636364
## [5,]          0.5416667          0.7272727
## [6,]          0.8750000          0.6363636</code></pre>
</div>
<div id="section-14" class="section level3">
<h3>2</h3>
<p><strong>Q:</strong> Use <code>vapply()</code> to:</p>
<ul>
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use <code>vapply()</code> twice.)</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(stn <span class="ot">&lt;-</span> <span class="fu">vapply</span>(X, sd, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     Sepal L..Setosa     Sepal W..Setosa     Petal L..Setosa     Petal W..Setosa 
##           0.3524897           0.3790644           0.1736640           0.1053856 
## Sepal L..Versicolor Sepal W..Versicolor Petal L..Versicolor Petal W..Versicolor 
##           0.5161711           0.3137983           0.4699110           0.1977527 
##  Sepal L..Virginica  Sepal W..Virginica  Petal L..Virginica  Petal W..Virginica 
##           0.6358796           0.3224966           0.5518947           0.2746501</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(stm <span class="ot">&lt;-</span> <span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],  sd, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
<div id="section-15" class="section level3">
<h3>3</h3>
<ul>
<li>implement by R</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, n){</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(x0)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  sam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">numeric</span>(p<span class="sc">*</span>n), <span class="at">nrow =</span> n)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  sam[<span class="dv">1</span>,] <span class="ot">&lt;-</span> x0</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">0.19</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    sam[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>sam[i<span class="dv">-1</span>,<span class="dv">2</span>], sig)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    sam[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>sam[i,<span class="dv">1</span>], sig)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sam)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>implement by C++</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>using namespace Rcpp<span class="op">;</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>NumericMatrix GibbsC<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> y0<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  NumericMatrix mat<span class="op">(</span>n<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">;</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> y <span class="op">=</span> y0<span class="op">;</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> sig <span class="op">=</span> sqrt<span class="op">(</span><span class="fl">0.19</span><span class="op">);</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="fl">0.9</span><span class="op">*</span>y<span class="op">,</span> sig<span class="op">)[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="fl">0.9</span><span class="op">*</span>x<span class="op">,</span> sig<span class="op">)[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>mat<span class="op">);</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ul>
<li>compare</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">GibbsR</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1000</span>),</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gibbsC=</span><span class="fu">GibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1000</span>))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr        lq    median       uq
## 1 gibbsR 3428.7505 3639.4515 3949.351
## 2 gibbsC  451.7015  460.8515  493.551</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="fu">GibbsR</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1000</span>)[<span class="dv">500</span><span class="sc">:</span><span class="dv">1000</span>,]</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>gibbsC <span class="ot">&lt;-</span> <span class="fu">GibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1000</span>)[<span class="dv">500</span><span class="sc">:</span><span class="dv">1000</span>,]</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsR[,<span class="dv">1</span>], gibbsC[,<span class="dv">1</span>])</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsR[,<span class="dv">2</span>], gibbsC[,<span class="dv">2</span>])</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
